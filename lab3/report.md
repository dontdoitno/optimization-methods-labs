# Решение задачи условной выпуклой оптимизации с помощью метода множителей Лагранжа

Персук Виктория Петровна, К3340. У меня 7 вариант

![](/lab3/src/task.png)

## Решение при помощи ChatGPT

Найти минимум функции

$$ 
f(x,y)=(x-2)^2+(y+3)^2 
$$
при равенствах
$$
g_1(x,y)=3x+2y-4=0,\qquad g_2(x,y)=x-y-1=0.
$$

### 1. Метод множителей Лагранжа

Составим лагранжиан

$$
\mathcal L(x,y,\lambda_1,\lambda_2)= (x-2)^2+(y+3)^2 + \lambda_1(3x+2y-4)+\lambda_2(x-y-1).
$$

Условие стационарности:

$$
\begin{cases}
\partial_x\mathcal L = 2(x-2)+3\lambda_1+\lambda_2 = 0,\\
\partial_y\mathcal L = 2(y+3)+2\lambda_1-\lambda_2 = 0,\\
3x+2y-4=0,\\
x-y-1=0.
\end{cases}
$$

Решим сначала систему ограничений (они линейны):

$$
\begin{cases}
3x+2y=4,\\
x-y=1.
\end{cases}
$$

Из (x-y=1) получаем (x=y+1). Подставляя в первое:

$$
3(y+1)+2y=4 \Rightarrow 5y=1 \Rightarrow y=\tfrac{1}{5},\quad x=\tfrac{6}{5}.
$$

Подставим $x=\tfrac{6}{5},\ y=\tfrac{1}{5}$ в уравнения на лагранжины, найдём $\lambda_1,\lambda_2$:

$$
2\big(x-2\big)=2\big(\tfrac{6}{5}-2\big)=2\big(-\tfrac{4}{5}\big)=-\tfrac{8}{5},
$$

$$
2\big(y+3\big)=2\big(\tfrac{1}{5}+3\big)=2\big(\tfrac{16}{5}\big)=\tfrac{32}{5}.
$$

Система для множителей:

$$
\begin{cases}
-\tfrac{8}{5}=3\lambda_1+\lambda_2,\\
\tfrac{32}{5}=2\lambda_1-\lambda_2.
\end{cases}
$$

Складывая оба уравнения: $\tfrac{24}{5}=5\lambda_1\Rightarrow \lambda_1=\tfrac{24}{25}.$
Тогда $\lambda_2=-\tfrac{8}{5}-3\lambda_1=-\tfrac{8}{5}-\tfrac{72}{25}=-\tfrac{112}{25}.$

### 2. Значение функции в найденной точке

$$
f\Big(\tfrac{6}{5},\tfrac{1}{5}\Big)=\Big(\tfrac{6}{5}-2\Big)^2+\Big(\tfrac{1}{5}+3\Big)^2
=\Big(-\tfrac{4}{5}\Big)^2+\Big(\tfrac{16}{5}\Big)^2=\tfrac{16}{25}+\tfrac{256}{25}=\tfrac{272}{25}=10.88.
$$

### 3. Проверка характера точки (критерий Сильвестра)

Гессиан целевой функции $f$ по переменным $(x,y)$ постоянен:

$$
\nabla^2 f=\begin{pmatrix}2&0\\
0&2\end{pmatrix}=2I.
$$

Применим критерий Сильвестра к этой симметричной матрице: ведущие главные миноры

$$
\Delta_1=2>0,\qquad \Delta_2=\det(2I)=4>0.
$$

Оба положительны, значит $\nabla^2 f$ положительно определённа.

Для задачи с равенствами достаточно, что квадратичная форма, заданная гессианом $f$, положительна на тангенциальном подпространстве допустимых направлений. У нас матрица градиентов ограничений

$$
G=\begin{pmatrix}3&2\\
1&-1\end{pmatrix}
$$

имеет ненулевой детерминант $(\det G=-5\neq0)$, следовательно множество направлений, удовлетворяющих $Gv=0$, тривиально (только $v=0$). В таком случае требование положительности на тангенциальном подпространстве выполняется (вакуозно), а положительно определённый гессиан гарантирует, что найденная стационарная точка — строгий локальный (а при квадратичном и выпуклом $f$ — и глобальный) минимум на множестве ограничений.

Также интуитивно: $f$ — строго выпуклая функция (положительно определённый гессиан), ограничения аффинны, следовательно пересечение уровня выпуклой функции с аффинным множеством даёт единственный глобальный минимум.

### Ответ

Глобальный минимум достигается в точке

$$
\boxed{\left(x,y\right)=\left(\tfrac{6}{5},\tfrac{1}{5}\right)}
$$

со значением $f=\tfrac{272}{25}=10.88$. Множители Лагранжа: $\lambda_1=\tfrac{24}{25},\ \lambda_2=-\tfrac{112}{25}$. Точка является строгим (и в данном случае — глобальным) минимумом, поскольку гессиан положительно определён (по критерию Сильвестра).

## Мои комментарии

В целом с решением задачи условной выпуклой оптимизации с помощью метода Лагранжа БЯМ справился, всё посчитал верно и методологию правильную использовал.

Главные косяки пошли уже после проверки ответа с применение критерия Сильвестра. У него неверные рассуждения. Критерий Сильвестра для безусловного гессиана функции $f$ неприменим напрямую к задачам с ограничениями-равенствами. Достаточные условия второго порядка для условной оптимизации требуют проверки:

1. Окаймленного гессиана (bordered Hessian) - специальной матрицы, включающей градиенты ограничений
2. Знакоопределенности гессиана Лагранжиана на касательном подпространстве - проверки условия $v^T H_L v > 0$ для всех $v \neq 0$ таких, что $\nabla g_i \cdot v = 0$

Что сделал ChatGPT:
- Вычислил гессиан целевой функции $f$: $\nabla^2 f = 2I$
- Применил критерий Сильвестра к этому гессиану
- Сделал вывод о минимуме на основании положительной определенности

Интерпретация ChatGPT в конце верная, но содержит логический пробел. "Положительно определённый гессиан гарантирует минимум" - это верно, но вследствие выпуклости, а не критерия Сильвестра напрямую

## Рефлективное заключение

Решение демонстрирует высокую техническую компетентность в базовых вычислениях метода Лагранжа, но теоретическую неточность в применении достаточных условий второго порядка.

Сильные стороны:
- Все вычисления (стационарные точки, множители, значение функции) выполнены безошибочно
- Правильно применены необходимые условия первого порядка
- Итоговый ответ корректен

Ключевая проблема:
ChatGPT смешал два разных подхода:
1. Критерий Сильвестра для безусловной оптимизации (проверяет $\nabla^2 f$)
2. Достаточные условия для условной оптимизации (проверяют окаймленный гессиан или $\nabla^2 \mathcal{L}$ на $T$)

В данной задаче это не привело к неправильному ответу благодаря вырожденности (касательное подпространство нульмерно) и выпуклости целевой функции. Однако в общем случае такой подход некорректен.
